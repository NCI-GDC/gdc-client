#!/usr/bin/env python
import logging
import sys

from gdc_client.version import __version__ as version
from gdc_client.argparser import argparser
from gdc_client import download, upload
from gdc_client.log import get_logger

logging.root.setLevel(logging.INFO)
log = get_logger('gdc-client')


DEFAULT_COMMAND = download.main
commands_callbacks = {
    download.command: download.main,
    upload.command: upload.main,
}


def log_version_header():
    log.info('gdc-client - {version}'.format(version=version))


def run_command(args):
    commands_callbacks[args.command](False)


def print_help():
    print "usage: gdc-client [upload/download/interactive] [arguments]"
    print "       upload - mode to upload files (without args to get help)"
    print "       download - mode to download files (without args to get help)"
    print "       interactive - runs in interactive mode for both download or upload (arguments ignored)"

def main():
    if not sys.argv[1:]:
        # If no subcommand was specified use default command
        print_help()
        return
        #return DEFAULT_COMMAND()
    if sys.argv[1] == "interactive":
        sys.argv.remove("interactive")
        commands_callbacks[download.command](True)
    else:
        args = argparser.parse_args()
        log_version_header()
        run_command(args)


if __name__ == '__main__':
    try:
        main()
    except KeyboardInterrupt:
        print('\nProcess canceled by user.')
