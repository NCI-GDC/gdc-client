#!/usr/bin/env python
import logging
import sys

from gdc_client.version import __version__ as version
from gdc_client.argparser import argparser, subparsers
from gdc_client import download, upload, interactive
from gdc_client.log import get_logger

logging.root.setLevel(logging.INFO)
log = get_logger('gdc-client')


DEFAULT_COMMAND = download.main
commands_callbacks = {
    download.command: download.main,
    upload.command: upload.main,
}


def log_version_header():
    log.info('gdc-client - {version}'.format(version=version))


def run_command(args):

    # NOTE this if clause only here because of download / upload
    if args.func is not None:
        return args.func(args)

    commands_callbacks[args.command](False)


if __name__ == '__main__':

    argparser.set_defaults(func=None)

    interactive_subparser = subparsers.add_parser('interactive',
        help='run in interactive mode',
    )
    interactive.parser.config(interactive_subparser)

    # TODO add download subparser
    # TODO add upload subparser

    args = argparser.parse_args()
    log_version_header()

    try:
        run_command(args)
    except KeyboardInterrupt:
        print('\nProcess canceled by user.')
